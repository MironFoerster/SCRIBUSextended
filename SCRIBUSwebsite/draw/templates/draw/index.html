{% extends 'base/base.html' %}

{% block beforeloadscript %}
const menu_url = {% url 'home:index' %}
const generate_url = {% url 'draw:generate' %}
const save_url = {% url 'draw:save' %}
const robodraw_url = {% url 'draw:robodraw' %}
{% endblock %}

{% block body %}
<div id="main-grid" data-state="draw_sub">
    <div id="draw-sub" class="subpage">
        <div id="left-ctrl-pane" class="draw-ctrl-pane">
            <input type="radio" name="draw_ctrl" id="scribe" onclick="manageDrawCtrl(event)" value="scribe">
            <label for="scribe" class="draw-ctrl-btn">
                <img class="icon" src="{% static 'imgs/scribe.svg' %}">
                <img class="icon-checked" src="{% static 'imgs/scribe_checked.svg' %}">
            </label>
            <div id="scribe-overlay" class="overlay">
                <div id="scribe-generate-sub">
                    <textarea id="scribe-text-input" name="scribe-text-input" placeholder="Here goes the text you want SCRIBUS to write!" oninput="getTextWarning(event)"></textarea>
                    <div id="generate-btn" onclick="generateHandwriting(event)">GENERATE</div>
                </div>
                <div id="scribe-adjust-sub">
                    <div id="align-ctrl">
                        <input type="radio" name="align" id="left-radio" onclick="updateAdjustCvs()" value="left" checked>
                        <label for="left-radio">LEFT</label>
                        <br>
                        <input type="radio" name="align" id="center-radio" onclick="updateAdjustCvs()" value="center">
                        <label for="center-radio">CENTER</label>
                        <br>
                        <input type="radio" name="align" id="right-radio" onclick="updateAdjustCvs()" value="right">
                        <label for="right-radio">RIGHT</label>
                        <br>
                    </div>
                    <div id="adjust-cvs-placeholder">
                        <canvas id="adjust-cvs" width=1000 height=1000></canvas>
                    </div>
                    <input type="range" id="ratio-range" name="ratio-range" min="0" max="100" oninput="updateAdjustCvs()">
                </div>
            </div>

            <input type="radio" name="draw_ctrl" id="shapes" onclick="manageDrawCtrl(event)" value="shapes">
            <label for="shapes" class="draw-ctrl-btn">
                <img class="icon" src="{% static 'imgs/shapes.svg' %}">
                <img class="icon-checked" src="{% static 'imgs/shapes_checked.svg' %}">
            </label>
            <div id="shapes-overlay" class="overlay">
                <div class="shadowbox"></div>
                <div class="scrollbox">
                    {% for shape in shapes.all %}
                        <script>global.shapes.push({'{{ shape.name }}': {{ shape.elements.elements|safe }}})</script>
                        <canvas id="{{ shape.name }}-shape" class="card-cvs shape-card-cvs" width=1000 height=1000 data-name="{{ shape.name }}" data-state="default" onload="drawShapeCanvas('{{ shape.name }}')" onclick="toggleShape(event)"></canvas>
                    {% endfor %}
                </div>
            </div>

            <input type="radio" name="draw_ctrl" id="galery" onclick="manageDrawCtrl(event)" value="galery">
            <label for="galery" class="draw-ctrl-btn">
                <img class="icon" src="{% static 'imgs/galery.svg' %}">
                <img class="icon-checked" src="{% static 'imgs/galery_checked.svg' %}">
            </label>
            <div id="galery-overlay" class="overlay">
                <div class="shadowbox"></div>
                <div class="scrollbox">
                    {% for design in designs.all %}
                        <script>global.designs.push({'{{ design.name }}': {{ design.elements.elements|safe }}})</script>
                        <div id="card-layer-grid">
                            <canvas id="{{ design.name }}-design" class="card-cvs design-card-cvs" width=1000 height=1000 data-name="{{ design.name }}" data-state="default" onload="drawDesignCanvas('{{ design.name }}')" onclick="toggleDesign(event)"></canvas>
                            <div id="card-overlay" data-state="off">{{ design.name }}</div>
                        </div>
                    {% endfor %}
                </div>
            </div>
        </div>

        <canvas id="main-cvs" width=1000 height=1000></canvas>

        <div id="right-ctrl-pane" class="draw-ctrl-pane">
            <input type="radio" name="draw_ctrl" id="pen" onclick="manageDrawCtrl(event)" value="pen">
            <label for="pen" class="draw-ctrl-btn">
                <img class="icon" src="{% static 'imgs/pen.svg' %}">
                <img class="icon-checked" src="{% static 'imgs/pen_checked.svg' %}">
            </label>

            <input type="radio" name="draw_ctrl" id="pointer" onclick="manageDrawCtrl(event)" value="pointer" checked>
            <label for="pointer" class="draw-ctrl-btn">
                <img class="icon" src="{% static 'imgs/pointer.svg' %}">
                <img class="icon-checked" src="{% static 'imgs/pointer_checked.svg' %}">
            </label>

            <div id="cancel" class="draw-okcancel-btn" onclick="manageDrawCtrl(event)" data-state="default">
                <img class="icon" src="{% static 'imgs/cancel.svg' %}">
                <img class="icon-checked" src="{% static 'imgs/cancel_checked.svg' %}">
            </div>

            <div id="ok" class="draw-okcancel-btn" onclick="manageDrawCtrl(event)" data-state="default">
                <img class="icon" src="{% static 'imgs/ok.svg' %}">
                <img class="icon-checked" src="{% static 'imgs/ok_checked.svg' %}">
            </div>

        </div>

    </div>

    <div id="finish-sub" class="subpage">

        <div id="left-finish-pane">
            <div id="draw-title">TITLE</div>
            <canvas id="finish-cvs" width=1000 height=1000></canvas>
            <img id="back-btn" src="{% static 'imgs/back.svg' %}" onclick="createPopup('Do you want to go back to DRAW or straight back to MENU?', ['CANCEL', 'DRAW', 'MENU'], ['', 'resetOnLeave(); document.getElementById(\'main-grid\').data-state=\'draw_sub\'', 'resetOnLeave(); window.location.href=menu_url'])">
        </div>

        <div id="vl"></div>

        <div id="right-finish-pane">
            <div id="nameit">NAME IT</div>
            <input type="text" id="name-input" pattern="" name="title-input" placeholder="BeautifulDrawing" oninput="updateNameWarning(event, {{ all_designnames|safe }}); updateTitle(event);">
            <p id="name-warning">min 4 letters</p>
            <div id="saveit">SAVE IT</div>
            <div id="save-grid" class="split-btn-grid" data-state="before">
                <div id="save-btn" class="before-split-btn" onclick="event.currentTarget.parentElement.data-state='after'; saveNamedDesign(event)">
                    <img src="{% static 'imgs/save.svg' %}">
                    <div class="vl-btn"></div>
                    <div>SAVE</div>
                </div>
                <div id="saved-btn" class="after-split-btn">
                    <img src="{% static 'imgs/saved.svg' %}">
                    <div class="vl-btn"></div>
                    <div>SAVED</div>
                </div>
            </div>
            <div id="getit">GET IT</div>
            <div id="getit-flex">
                <div id="download-grid" class="split-btn-grid" data-state="before">
                    <div id="download-btn" class="before-split-btn" onclick="event.currentTarget.parentElement.data-state='after'; downloadNamedDesign(event)">
                        <img src="{% static 'imgs/download.svg' %}">
                        <div class="vl-btn"></div>
                        <div>DOWNLOAD</div>
                    </div>
                    <div id="download-again-btn" class="after-split-btn" onclick="downloadNamedDesign(event)">
                        <img src="{% static 'imgs/download_again.svg' %}">
                        <div class="vl-btn"></div>
                        <div>DOWNLOAD AGAIN</div>
                    </div>
                </div>
                <div id="robot-draw-grid" class="split-btn-grid" data-state="before">
                    <div id="robot-draw-btn" class="before-split-btn" onclick="event.currentTarget.parentElement.data-state='after'; sendDesignToRobot(event)">
                        <div>LET SCRIBUS DRAW</div>
                    </div>
                    <div id="robot-draw-again-btn" class="after-split-btn" onclick="sendDesignToRobot(event)">
                        <div id="sent-count">1x</div>
                        <div class="vl-btn"></div>
                        <div>+1 DRAWING</div>
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>
{% endblock %}

{% block scriptsource %}
{% load static %}
{% static 'base/js/draw.js' %}
{% endblock %}